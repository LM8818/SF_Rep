@startuml
!define BANKING_BLUE #1E3A8A
!define BANKING_LIGHT_BLUE #3B82F6
!define BANKING_GREEN #059669
!define BANKING_LIGHT_GREEN #10B981
!define BANKING_ORANGE #EA580C

title <size:16><color:#1E3A8A><b>üè¶ Banking NLP v2.0: –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞</b></color></size>

skinparam backgroundColor #F8FAFC
skinparam handwritten false
skinparam roundcorner 15
skinparam shadowing true
skinparam defaultFontName "Segoe UI"
skinparam defaultFontSize 11
skinparam defaultFontColor #1E3A8A

skinparam ParticipantBackgroundColor #EFF6FF
skinparam ParticipantBorderColor #3B82F6
skinparam ParticipantFontColor #1E3A8A
skinparam ParticipantFontSize 11
skinparam ParticipantFontStyle bold

skinparam DatabaseBackgroundColor #F0FDF4
skinparam DatabaseBorderColor #10B981

skinparam ArrowColor #3B82F6
skinparam ArrowThickness 2
skinparam SequenceMessageAlign center

skinparam NoteBackgroundColor #FFFBEB
skinparam NoteBorderColor #F59E0B
skinparam NoteFontColor #1E3A8A

actor "üë§ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**" as User
participant "üíª **Frontend**" as FE
participant "üöÄ **FastAPI**" as API
participant "üß† **NLP Service**" as NLP
database "üíæ **Storage**" as ST

User -> FE : üìù –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
activate FE #EFF6FF

FE -> API : üì§ POST /api/v1/nlp/analyze
activate API #EFF6FF
note right #FFFBEB : JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è\n–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞

API -> NLP : üîç analyze_conversation(text, metadata)
activate NLP #F0FDF4

NLP -> ST : üì• load_model()
activate ST #F0FDF4
ST --> NLP : ü§ñ model object
deactivate ST

NLP -> NLP : üßπ **–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞**\n–æ—á–∏—Å—Ç–∫–∞, —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è
NLP -> NLP : ‚öôÔ∏è **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**\nTF-IDF, –¥–ª–∏–Ω–∞, —ç–º–æ—Ü–∏–∏
NLP -> NLP : üéØ **–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ**\n—Ç–µ–º–∞, –ø—Ä–æ–¥—É–∫—Ç—ã, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å

NLP -> ST : üìä log_analysis_result()
activate ST #F0FDF4
ST --> NLP : ‚úÖ success
deactivate ST

NLP --> API : üìã ConversationAnalysisResponse
deactivate NLP
note left #FFFBEB : JSON —Å –ø–æ–ª–Ω—ã–º–∏\n—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞

API --> FE : üì¶ JSON —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
deactivate API

FE -> FE : üé® **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**\n—Ç–µ–º–∞, —ç–º–æ—Ü–∏—è, –ø—Ä–æ–¥—É–∫—Ç—ã
FE --> User : üìä –¥–∞—à–±–æ—Ä–¥ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
deactivate FE

note over User, ST #F8FAFC : <b>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</b> < 2 –º–∏–Ω—É—Ç\n<b>–¢–æ—á–Ω–æ—Å—Ç—å:</b> ‚â• 85%\n<b>–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å:</b> 10,000+ –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å
@enduml
